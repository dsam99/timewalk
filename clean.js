data =
  [
    {
      'position': {
        'lat': 42.3807121,
        'lng': -71.1252919,
        'accuracy': 26,
        'alt': -17
      },
      'timestamp': 1540057556676,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 46,
            'temperature': 34
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3808269,
        'lng': -71.12527782,
        'accuracy': 35,
        'alt': -16
      },
      'timestamp': 1540057531363,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 46,
            'temperature': 33.9
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806567,
        'lng': -71.12531531,
        'accuracy': 32,
        'alt': -17
      },
      'timestamp': 1540057500071,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 46,
            'temperature': 33.9
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807051,
        'lng': -71.12537081,
        'accuracy': 32,
        'alt': -16
      },
      'timestamp': 1540057469918,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 46,
            'temperature': 33.9
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807897,
        'lng': -71.12530491,
        'accuracy': 37,
        'alt': -17
      },
      'timestamp': 1540057438589,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 46,
            'temperature': 33.8
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807423,
        'lng': -71.12535501,
        'accuracy': 40,
        'alt': -16
      },
      'timestamp': 1540057408450,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 46,
            'temperature': 33.8
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807241,
        'lng': -71.12540488,
        'accuracy': 26,
        'alt': -17
      },
      'timestamp': 1540057377207,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 46,
            'temperature': 33.8
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807824,
        'lng': -71.12527577,
        'accuracy': 36,
        'alt': -17
      },
      'timestamp': 1540057347069,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 46,
            'temperature': 33.7
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807249,
        'lng': -71.12534574,
        'accuracy': 38,
        'alt': -17
      },
      'timestamp': 1540057316178,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.7
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806097,
        'lng': -71.12535864,
        'accuracy': 28,
        'alt': -18
      },
      'timestamp': 1540057296173,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.7
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.380784,
        'lng': -71.12531858,
        'accuracy': 38,
        'alt': -15
      },
      'timestamp': 1540057272488,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.7
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807831,
        'lng': -71.12531978,
        'accuracy': 33,
        'alt': -17
      },
      'timestamp': 1540057242388,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.7
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807512,
        'lng': -71.12528176,
        'accuracy': 39,
        'alt': -16
      },
      'timestamp': 1540057211138,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.7
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807397,
        'lng': -71.1253325,
        'accuracy': 41,
        'alt': -16
      },
      'timestamp': 1540057181016,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.7
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806849,
        'lng': -71.12541712,
        'accuracy': 30,
        'alt': -19
      },
      'timestamp': 1540057149616,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.6
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806831,
        'lng': -71.12542394,
        'accuracy': 26,
        'alt': -17
      },
      'timestamp': 1540057119503,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.6
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807188,
        'lng': -71.12526399,
        'accuracy': 34,
        'alt': -18
      },
      'timestamp': 1540057088273,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.5
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807906,
        'lng': -71.12533682,
        'accuracy': 35,
        'alt': -16
      },
      'timestamp': 1540057058138,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.3
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806503,
        'lng': -71.12524618,
        'accuracy': 39,
        'alt': -16
      },
      'timestamp': 1540057026956,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.2
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3808241,
        'lng': -71.12530287,
        'accuracy': 36,
        'alt': -15
      },
      'timestamp': 1540056996856,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33.1
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806723,
        'lng': -71.12535728,
        'accuracy': 31,
        'alt': -16
      },
      'timestamp': 1540056965824,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 33
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806847,
        'lng': -71.12532057,
        'accuracy': 26,
        'alt': -17
      },
      'timestamp': 1540056935737,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 32.9
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806863,
        'lng': -71.12534455,
        'accuracy': 32,
        'alt': -17
      },
      'timestamp': 1540056904701,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 32.8
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807918,
        'lng': -71.12531546,
        'accuracy': 36,
        'alt': -16
      },
      'timestamp': 1540056874575,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 47,
            'temperature': 32.7
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807936,
        'lng': -71.12531049,
        'accuracy': 34,
        'alt': -16
      },
      'timestamp': 1540056843680,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 32.5
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806806,
        'lng': -71.12534062,
        'accuracy': 29,
        'alt': -17
      },
      'timestamp': 1540056813567,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 32.4
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3808057,
        'lng': -71.12527146,
        'accuracy': 33,
        'alt': -15
      },
      'timestamp': 1540056782665,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 32.3
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806381,
        'lng': -71.12534183,
        'accuracy': 26,
        'alt': -17
      },
      'timestamp': 1540056752520,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 32.2
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807624,
        'lng': -71.12533346,
        'accuracy': 35,
        'alt': -15
      },
      'timestamp': 1540056721364,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 32.1
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807351,
        'lng': -71.12536517,
        'accuracy': 29,
        'alt': -16
      },
      'timestamp': 1540056691263,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 32
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806917,
        'lng': -71.12534943,
        'accuracy': 24,
        'alt': -16
      },
      'timestamp': 1540056659494,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 31.9
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806431,
        'lng': -71.12539323,
        'accuracy': 30,
        'alt': -17
      },
      'timestamp': 1540056629350,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 31.7
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807626,
        'lng': -71.12533243,
        'accuracy': 38,
        'alt': -15
      },
      'timestamp': 1540056598380,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 31.6
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807006,
        'lng': -71.12532717,
        'accuracy': 30,
        'alt': -17
      },
      'timestamp': 1540056568227,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 31.5
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806757,
        'lng': -71.1252988,
        'accuracy': 37,
        'alt': -19
      },
      'timestamp': 1540056537139,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 31.3
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806309,
        'lng': -71.12530716,
        'accuracy': 31,
        'alt': -18
      },
      'timestamp': 1540056506940,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 31.2
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806712,
        'lng': -71.12529689,
        'accuracy': 41,
        'alt': -16
      },
      'timestamp': 1540056475853,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 48,
            'temperature': 31.2
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807244,
        'lng': -71.12527847,
        'accuracy': 41,
        'alt': -18
      },
      'timestamp': 1540056445747,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 31.2
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3805676,
        'lng': -71.1252422,
        'accuracy': 32,
        'alt': -19
      },
      'timestamp': 1540056414762,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 31.1
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807012,
        'lng': -71.12528963,
        'accuracy': 34,
        'alt': -17
      },
      'timestamp': 1540056384626,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 31.1
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.380689,
        'lng': -71.1253352,
        'accuracy': 29,
        'alt': -17
      },
      'timestamp': 1540056353529,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 31
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806277,
        'lng': -71.12526809,
        'accuracy': 36,
        'alt': -17
      },
      'timestamp': 1540056323364,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.9
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807604,
        'lng': -71.12532459,
        'accuracy': 36,
        'alt': -17
      },
      'timestamp': 1540056292130,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.9
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.380708,
        'lng': -71.12537074,
        'accuracy': 30,
        'alt': -17
      },
      'timestamp': 1540056261996,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.8
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807469,
        'lng': -71.12535065,
        'accuracy': 28,
        'alt': -15
      },
      'timestamp': 1540056230827,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.8
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806692,
        'lng': -71.12534558,
        'accuracy': 31,
        'alt': -16
      },
      'timestamp': 1540056200695,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.8
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806863,
        'lng': -71.1254063,
        'accuracy': 28,
        'alt': -17
      },
      'timestamp': 1540056169727,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.8
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806538,
        'lng': -71.12537808,
        'accuracy': 28,
        'alt': -18
      },
      'timestamp': 1540056139621,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.8
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807428,
        'lng': -71.1253893,
        'accuracy': 24,
        'alt': -16
      },
      'timestamp': 1540056107858,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.6
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.380803,
        'lng': -71.1253222,
        'accuracy': 33,
        'alt': -16
      },
      'timestamp': 1540056077724,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.5
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807438,
        'lng': -71.12527628,
        'accuracy': 31,
        'alt': -16
      },
      'timestamp': 1540056046835,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.4
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3808232,
        'lng': -71.12533462,
        'accuracy': 32,
        'alt': -16
      },
      'timestamp': 1540056016757,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.3
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807151,
        'lng': -71.12535969,
        'accuracy': 30,
        'alt': -15
      },
      'timestamp': 1540055985879,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 49,
            'temperature': 30.2
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807282,
        'lng': -71.12528142,
        'accuracy': 26,
        'alt': -16
      },
      'timestamp': 1540055955701,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 50,
            'temperature': 29.9
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806243,
        'lng': -71.12534065,
        'accuracy': 22,
        'alt': -18
      },
      'timestamp': 1540055935680,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 50,
            'temperature': 29.5
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806667,
        'lng': -71.12537049,
        'accuracy': 24,
        'alt': -17
      },
      'timestamp': 1540055915667,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 50,
            'temperature': 28.9
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3806203,
        'lng': -71.12534435,
        'accuracy': 23,
        'alt': -18
      },
      'timestamp': 1540055895649,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 50,
            'temperature': 28.9
          }
        }
      }
    },
    {
      'position': {
        'lat': 42.3807228,
        'lng': -71.12535664,
        'accuracy': 29,
        'alt': -17
      },
      'timestamp': 1540055875565,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 50,
            'temperature': 28.6
          },
          'icon': 'PHONE',
          'name': 'waitpid'
        }
      }
    },
    {
      'position': {
        'lat': 42.3806966,
        'lng': -71.12541932,
        'accuracy': 24,
        'alt': -17
      },
      'timestamp': 1540055863657,
      'payload': {
        'refAppData': {
          'batteryState': {
            'charging': false,
            'level': 50,
            'temperature': 28.6
          }
        }
      }
    }
]

/**
 * Function to clean the json object to only contain lat/long values a certain
 * distance apart
 * @param {*} json_list - a list of json objects to be cleaned
 * @return - the cleaned json object 
 */
function clean_lat_longs (json_list) {
  last_lat = 0
  last_long = 0

  // accumulator for cleaned location values
  final = [];

  for (index in json_list) {
    json_obj = json_list[index]
    if (!((Math.abs(json_obj.position.lat - last_lat) < .0002) &&
      (Math.abs(json_obj.position.lng - last_long) < .0002))) {
      last_lat = json_obj.position.lat
      last_long = json_obj.position.lng

      temp = {
        'lat': last_lat,
        'long': last_long,
        'timestamp': json_obj.timestamp
      }
      final.push(temp)
    }
  }

  return final
}

// exporting clean_lat_longs to use in api.js
module.exports = {
  clean_lat_longs: clean_lat_longs
}

console.log(clean_lat_longs(data))
